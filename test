<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#1a1a2e">
  <title>Chariot V2</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      color: white;
      padding: 15px;
      min-height: 100vh;
      user-select: none;
    }
    .container { max-width: 500px; margin: 0 auto; }
    
    /* HEADER */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background: rgba(255,255,255,0.05);
      border-radius: 15px;
      margin-bottom: 20px;
      backdrop-filter: blur(10px);
    }
    .header h1 { font-size: 22px; font-weight: 600; }
    .bt-btn {
      padding: 8px 16px;
      background: #4ade80;
      border: none;
      border-radius: 8px;
      color: #1a1a2e;
      font-weight: 600;
      cursor: pointer;
      font-size: 13px;
    }
    .bt-btn:disabled { background: #555; cursor: not-allowed; }
    .bt-status {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #ef4444;
      margin-left: 8px;
      display: inline-block;
      animation: pulse 2s infinite;
    }
    .bt-status.connected { background: #4ade80; }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    
    /* JAUGE SOC PRINCIPALE */
    .gauge-main {
      position: relative;
      width: 100%;
      max-width: 280px;
      margin: 25px auto;
    }
    .gauge-svg {
      width: 100%;
      height: auto;
      filter: drop-shadow(0 8px 20px rgba(0,0,0,0.4));
    }
    .gauge-center {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      width: 100%;
    }
    .gauge-value {
      font-size: 56px;
      font-weight: 700;
      line-height: 1;
      background: linear-gradient(135deg, #4ade80, #22c55e);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .gauge-label {
      font-size: 13px;
      opacity: 0.6;
      margin-top: 8px;
      letter-spacing: 1px;
    }
    .gauge-sub {
      font-size: 20px;
      font-weight: 600;
      margin-top: 8px;
      color: #a0aec0;
    }
    .gauge-voltage {
      font-size: 16px;
      margin-top: 5px;
      opacity: 0.8;
    }
    
    /* MINI JAUGES */
    .mini-gauges {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin: 25px 0;
    }
    .mini-gauge {
      background: rgba(255,255,255,0.05);
      border-radius: 15px;
      padding: 20px;
      text-align: center;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.1);
    }
    .mini-icon {
      font-size: 28px;
      margin-bottom: 10px;
    }
    .mini-value {
      font-size: 36px;
      font-weight: 700;
      margin: 10px 0;
    }
    .mini-label {
      font-size: 11px;
      opacity: 0.6;
      letter-spacing: 1px;
      text-transform: uppercase;
    }
    
    /* AUTONOMIE */
    .autonomy {
      background: rgba(255,255,255,0.05);
      border-radius: 15px;
      padding: 20px;
      margin: 20px 0;
      text-align: center;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.1);
    }
    .auto-value {
      font-size: 42px;
      font-weight: 700;
      background: linear-gradient(135deg, #3b82f6, #8b5cf6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .auto-label {
      font-size: 12px;
      opacity: 0.6;
      margin-top: 8px;
      letter-spacing: 1px;
    }
    .auto-time {
      font-size: 18px;
      margin-top: 8px;
      color: #a0aec0;
    }
    
    /* MODES */
    .modes {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 12px;
      margin: 25px 0;
    }
    .mode-btn {
      padding: 16px;
      border: 2px solid rgba(255,255,255,0.15);
      background: rgba(255,255,255,0.05);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 14px;
      font-weight: 600;
      color: white;
      backdrop-filter: blur(10px);
    }
    .mode-btn.active {
      border-color: #4ade80;
      background: rgba(74, 222, 128, 0.15);
      box-shadow: 0 0 25px rgba(74, 222, 128, 0.4);
      transform: scale(1.05);
    }
    
    /* TOGGLES */
    .toggles {
      background: rgba(255,255,255,0.05);
      border-radius: 15px;
      padding: 20px;
      margin: 20px 0;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.1);
    }
    .toggle-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 0;
      border-bottom: 1px solid rgba(255,255,255,0.08);
    }
    .toggle-item:last-child { border-bottom: none; }
    .toggle-label {
      font-size: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .toggle-switch {
      width: 52px;
      height: 28px;
      background: rgba(255,255,255,0.2);
      border-radius: 14px;
      position: relative;
      cursor: pointer;
      transition: background 0.3s;
    }
    .toggle-switch.active { background: #4ade80; }
    .toggle-slider {
      width: 24px;
      height: 24px;
      background: white;
      border-radius: 50%;
      position: absolute;
      top: 2px;
      left: 2px;
      transition: transform 0.3s;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }
    .toggle-switch.active .toggle-slider { transform: translateX(24px); }
    
    /* STATS */
    .stats {
      background: rgba(255,255,255,0.05);
      border-radius: 15px;
      padding: 18px;
      margin-top: 20px;
      display: flex;
      justify-content: space-around;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.1);
    }
    .stat {
      text-align: center;
    }
    .stat-value {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 6px;
    }
    .stat-label {
      font-size: 11px;
      opacity: 0.6;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- HEADER -->
    <div class="header">
      <h1>‚ö° CHARIOT V2</h1>
      <div>
        <button class="bt-btn" id="btBtn" onclick="connectBT()">Connecter BT</button>
        <span class="bt-status" id="btStatus"></span>
      </div>
    </div>
    
    <!-- JAUGE SOC PRINCIPALE -->
    <div class="gauge-main">
      <svg class="gauge-svg" viewBox="0 0 200 200">
        <circle cx="100" cy="100" r="85" fill="none" stroke="rgba(255,255,255,0.08)" stroke-width="22"/>
        <circle id="socCircle" cx="100" cy="100" r="85" fill="none" 
                stroke="url(#gradSoc)" stroke-width="22" stroke-linecap="round"
                stroke-dasharray="534" stroke-dashoffset="133.5"
                transform="rotate(-90 100 100)"
                style="transition: stroke-dashoffset 0.5s ease"/>
        <defs>
          <linearGradient id="gradSoc" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" style="stop-color:#4ade80"/>
            <stop offset="100%" style="stop-color:#22c55e"/>
          </linearGradient>
        </defs>
      </svg>
      <div class="gauge-center">
        <div class="gauge-value" id="socValue">85%</div>
        <div class="gauge-label">üîã BATTERIE</div>
        <div class="gauge-sub" id="socWh">306 Wh</div>
        <div class="gauge-voltage" id="voltage">36.8V</div>
      </div>
    </div>
    
    <!-- MINI JAUGES -->
    <div class="mini-gauges">
      <div class="mini-gauge">
        <div class="mini-icon">‚ö°</div>
        <div class="mini-value" id="powerValue">245W</div>
        <div class="mini-label">Consommation</div>
      </div>
      <div class="mini-gauge">
        <div class="mini-icon">‚òÄÔ∏è</div>
        <div class="mini-value" id="solarValue">+75W</div>
        <div class="mini-label">Solaire</div>
      </div>
    </div>
    
    <!-- AUTONOMIE -->
    <div class="autonomy">
      <div class="auto-value" id="autoKm">28 km</div>
      <div class="auto-label">üìè AUTONOMIE RESTANTE</div>
      <div class="auto-time" id="autoTime">1h 15min</div>
    </div>
    
    <!-- MODES -->
    <div class="modes">
      <button class="mode-btn active" id="btnEco" onclick="setMode('ECO')">ECO</button>
      <button class="mode-btn" id="btnNormal" onclick="setMode('NORMAL')">NORMAL</button>
      <button class="mode-btn" id="btnBoost" onclick="setMode('BOOST')">BOOST</button>
    </div>
    
    <!-- TOGGLES -->
    <div class="toggles">
      <div class="toggle-item">
        <div class="toggle-label">üéØ R√©gulateur vitesse</div>
        <div class="toggle-switch" id="cruiseSwitch" onclick="toggleCruise()">
          <div class="toggle-slider"></div>
        </div>
      </div>
      <div class="toggle-item">
        <div class="toggle-label">‚¨ÖÔ∏è Marche arri√®re</div>
        <div class="toggle-switch" id="reverseSwitch" onclick="toggleReverse()">
          <div class="toggle-slider"></div>
        </div>
      </div>
    </div>
    
    <!-- STATS -->
    <div class="stats">
      <div class="stat">
        <div class="stat-value" id="statDist">12.3 km</div>
        <div class="stat-label">Distance</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="statWh">245 Wh</div>
        <div class="stat-label">Consomm√©</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="statSpeed">18 km/h</div>
        <div class="stat-label">Vitesse</div>
      </div>
    </div>
  </div>

  <script>
    const BATTERY_CAPACITY = 360; // Wh
    let mode = 'ECO';
    
    // SIMULATION (sera remplac√© par vraies donn√©es Bluetooth)
    function simulate() {
      const soc = 85 - Math.random() * 0.5;
      const power = mode === 'ECO' ? 150 : mode === 'NORMAL' ? 250 : 400;
      const powerVar = power + (Math.random() - 0.5) * 50;
      const solar = 70 + (Math.random() - 0.5) * 20;
      const speed = 15 + Math.random() * 5;
      
      updateUI({
        soc: soc,
        voltage: 36.8,
        power: powerVar,
        solar: solar,
        speed: speed,
        distance: 12.3,
        consumed: 245
      });
    }
    
    function updateUI(data) {
      // SOC
      const soc = data.soc;
      const circumference = 2 * Math.PI * 85;
      const offset = circumference - (soc / 100) * circumference;
      document.getElementById('socCircle').style.strokeDashoffset = offset;
      document.getElementById('socValue').textContent = Math.round(soc) + '%';
      document.getElementById('socWh').textContent = Math.round(BATTERY_CAPACITY * soc / 100) + ' Wh';
      
      // Voltage
      document.getElementById('voltage').textContent = data.voltage.toFixed(1) + 'V';
      
      // Power & Solar
      document.getElementById('powerValue').textContent = Math.round(data.power) + 'W';
      document.getElementById('solarValue').textContent = '+' + Math.round(data.solar) + 'W';
      
      // Autonomie
      const energyLeft = BATTERY_CAPACITY * (soc / 100);
      const netPower = data.power - data.solar;
      
      if (netPower > 0) {
        const hoursLeft = energyLeft / netPower;
        const kmLeft = hoursLeft * data.speed;
        const totalMins = Math.round(hoursLeft * 60);
        const hours = Math.floor(totalMins / 60);
        const mins = totalMins % 60;
        
        document.getElementById('autoKm').textContent = Math.round(kmLeft) + ' km';
        document.getElementById('autoTime').textContent = hours + 'h ' + mins + 'min';
      } else {
        document.getElementById('autoKm').textContent = '‚ôæÔ∏è';
        document.getElementById('autoTime').textContent = 'Recharge en cours';
      }
      
      // Stats
      document.getElementById('statDist').textContent = data.distance.toFixed(1) + ' km';
      document.getElementById('statWh').textContent = Math.round(data.consumed) + ' Wh';
      document.getElementById('statSpeed').textContent = data.speed.toFixed(1) + ' km/h';
    }
    
    function setMode(newMode) {
      mode = newMode;
      document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
      document.getElementById('btn' + newMode.charAt(0) + newMode.slice(1).toLowerCase()).classList.add('active');
      // Envoi BT: MODE:ECO|NORMAL|BOOST
    }
    
    function toggleCruise() {
      document.getElementById('cruiseSwitch').classList.toggle('active');
      // Envoi BT: CRUISE:0|1
    }
    
    function toggleReverse() {
      document.getElementById('reverseSwitch').classList.toggle('active');
      // Envoi BT: REVERSE:0|1
    }
    
    function connectBT() {
      // Code Bluetooth Web API ici
      alert('Bluetooth non impl√©ment√© dans la version test.\n√áa marchera sur GitHub Pages !');
    }
    
    // Simulation auto
    setInterval(simulate, 1000);
    simulate();
  </script>
</body>
</html>
